terraform:
  links:
    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#ftps_state
  good:
    - |-
      resource "azurerm_app_service" "good_example" {
        name                = "example-app-service"
        location            = azurerm_resource_group.example.location
        resource_group_name = azurerm_resource_group.example.name
        app_service_plan_id = azurerm_app_service_plan.example.id

        site_config {
          ftps_state = "FtpsOnly"
        }
      }
    - |-
      resource "azurerm_app_service" "good_example_disabled" {
        name                = "example-app-service"
        location            = azurerm_resource_group.example.location
        resource_group_name = azurerm_resource_group.example.name
        app_service_plan_id = azurerm_app_service_plan.example.id

        site_config {
          ftps_state = "Disabled"
        }
      }
  bad:
    - |-
      resource "azurerm_app_service" "bad_example" {
        name                = "example-app-service"
        location            = azurerm_resource_group.example.location
        resource_group_name = azurerm_resource_group.example.name
        app_service_plan_id = azurerm_app_service_plan.example.id

        site_config {
          ftps_state = "AllAllowed"
        }
      }
    - |-
      resource "azurerm_app_service" "bad_example_default" {
        name                = "example-app-service"
        location            = azurerm_resource_group.example.location
        resource_group_name = azurerm_resource_group.example.name
        app_service_plan_id = azurerm_app_service_plan.example.id

        site_config {
          # No ftps_state specified - defaults to insecure
        }
      }
